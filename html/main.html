<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <title>Hello APP</title>
    <link rel="stylesheet" type="text/css" href="../css/api.css" />
	<style>
		#con{
			margin: 10px;
			font-size: 24px; 
		}
		ul{
			margin-bottom: 10px;
		}
		ul li{ 
			margin: 5px 10px;
			padding: 5px;
			color: #000;
			word-wrap: break-word;
		}
	</style>
</head>
<body>
    <label id="con">Hellos2 APP</label>
	<div id='content'></div>
	<div id="online_box"></div>
</body>
<script type="text/javascript" src="../script/api.js"></script>
<script src='http://cdn.bootcss.com/socket.io/1.3.7/socket.io.js'></script>
<script type="text/javascript" src="../script/zepto.min.js"></script>
<script type="text/javascript">
    apiready = function(){
    	
    	//如监听网络连接事件
       //html页面a：
      setTimeout(function(){
            api.sendEvent({
                name: 'myEvent',
                extra: {
                    key1: 'value1',
                    key2: 'value3'
                }
            });
        },5000);
       
    };
    $(document).ready(function () {
    // 连接服务端
	    var socket = io('http://www.workerman.net:2120');
	    // 连接后登录
	    socket.on('connect', function(){
	    	socket.emit('login', "lxl");
	    });
	    // 后端推送来消息时
	    socket.on('new_msg', function(msg){
	         $('#content').html('收到消息：'+msg);
	    });
	    // 后端推送来在线数据时
	    socket.on('update_online_count', function(online_stat){
	        $('#online_box').html(online_stat);
	    });
	});
</script>
</html>